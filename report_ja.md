---
layout: post 
title: WebRTCセキュリティレポート
---

## あらまし

WebRTC(Web Real-Time Communication)は、Webアプリケーション技術の昨今のトレンドの一つだ。WeBRTCを利用すると、プラグイン無しで、また他の要件無しでリアルタイムコミュニケーションを実現できる。だが、オープンソースとしての性質により、WebRTCを採用しようとする人がセキュリティ上の不安を覚えることもあるだろう。本レポートはWebRTCのセキュリティについて明らかにする。(todo, comparative)

## 1. イントロダクション

WebRTCはオープンソースのWebベースの技術であり、ユーザがリアルタイムメディア通信を、プラグイン無しで実現することができる技術だ。適切なブラウザを利用すれば、ウェブサイトをブラウズするだけで、他者に発信して通話することができる。

WebRTCの主なユースケースは以下の通り：

- リアルタイムの音声/映像通信
- ウェブ会議
- P2Pでのデータ送受信

他のリアルタイムシステム(例えばSIP)と異なり、WebRTCの通信は、JavaScriptのAPIを通じてWebサーバによって制御される。

プラグイン無しで、音声映像の通信を可能にするという点は非常に興味深い。
だが、その性質自体がセキュリティに関する不安を引き起こしている。
また、エンドユーザ・通信事業者・サードパーティの両方にとって
信頼できる通信を提供できるかどうかについても、不安がある。

本レポートではこれらのトピックについて述べ、さらにWebRTCが全ての例に提供するセキュリティについて防衛方法について調査する。ただし、このレポートではネイティブアプリケーションは扱わない。

## 2. WebRTCアーキテクチャの概要

WebRTCはP2Pのトポロジ形式で、ピア間のメディア通信を実現する。
WeBRTCはユーザのブラウザに実装されており、追加のソフトウェアを必要としない。
ピア間の通信が始まる前には、「シグナリング」と呼ばれるメタ情報の交換が必要だ。
このシグナリングプロセスは、通信の開始時に利用され、ピア間の接続確立を実現する。
★unfamiliar parties ってどう訳す？

図1に示すように、シグナリングプロセスは中継サーバを経由して実現される。

                    +----------------+
                    |                |
                    |    Signaling   |
                    |    Server      |
                    |                |
                    +----------------+
                      ^           ^
                     /             \
         Signaling  /               \   Signaling
                   /                 \
                  /                   \
                 v                     v
               JS API                  JS API
          +-----------+             +-----------+
          |           |    Media    |           |
          |  Browser  |<----------->|  Browser  |
          |           |             |           |
          +-----------+             +-----------+
              Alice                      Bob

図1. WebRTCのシンプルなトポロジ例

シグナリングプロトコルはWebRTCで仕様規定されているわけではない。
これは開発者が自身の選択でプロトコルを選べるようにしているためだ。
ユースケースやシナリオに適したアプリケーションを柔軟に作れる。

### WebRTCの通信はどのように動作するのか？

WebRTCは3つのAPIから成っており、それぞれがリアルタイム通信を実現するために、特定の機能を実行する。
これらのAPIは以降で簡単に解説する。それぞれのプロトコルの技術的な詳細、実装については、このレポートで扱わないが、関連するドキュメントはオンラインで簡単に見つけられる。

### getUserMedia

WebRTC登場以前は、音声や映像の取得にはサードパーティのプラグイン（例えばFlashやSilverlight）が必要だった。だが、HTML5の時代になり、多くのデバイスについて直接アクセスする手段が出現し、JavaScriptのAPIがハードウェアの能力を利用できるようにあった。

getUserMediaはそのようなAPIの一つで、ブラウザからカメラ・マイクへアクセスするためのAPIだ。WebRTCで利用されるAPIだが、このAPIはHTML5の一つとして提供されている。

### RTCPeerConnection

https://developer.mozilla.org/en-US/docs/Web/API/RTCPeerConnection

RTCPeerConnectionは、WebRTC仕様として規定されるAPIのうちの1つだ。
RTCPeerConnectionインターフェースは、WebRTCの通信を示しており、
2つのピア間の効率的なデータ転送に利用される。

発信者がある着信先に通信を開始する場合、ブラウザはRTCPeerConnectionのインスタンスをまず作成する。このとき、自身が作成するSDP(Session Description Protocol)を、通信相手と交換する。
受信側でも、SDPを作成し発信側に応答する。SDPはNAT越えのためのICEワークフロの一部として利用される。

コネクションが確立したら、RTCPeerConnectionはブラウザ間で音声・映像のデータをビットストリームとして送れるようになる。

究極的には、





































